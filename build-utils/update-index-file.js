const fs = require('fs')
const path = require('path')
const componentNames = require('./component-names')

const indexFileContent = `\
// THIS FILE IS AUTOMATICALLY GENERATED IN:
//
//   build-utils/update-file-index.js
//
// YOU SHOULD NEVER UPDATE THIS FILE DIRECTLY

${componentNames
  .map(component => `import ${component.name} from './${component.path}.vue'`)
  .join('\n')}

// Export components individually
export { ${componentNames.map(component => component.name).join(', ')} }

// What should happen if the user installs the library as a plugin
function install(Vue) {
${componentNames
  .map(component => `  Vue.component('${component.name}', ${component.name})`)
  .join('\n')}
}

// Export the library as a plugin
export default { install: install }
`

fs.writeFileSync(path.resolve(__dirname, '../src/index.js'), indexFileContent)
